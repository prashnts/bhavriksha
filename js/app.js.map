{"version":3,"sources":["bhavriksha/app.coffee"],"names":[],"mappings":"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","file":"public/js/app.js","sourcesContent":["# Bhav Vriksha\n\nd3 = require 'd3'\n$ = require 'jquery'\n\nApp =\n  # coffeelint: disable=max_line_length\n  test_data: \"[[[[[{\\\"token\\\": \\\"\\\\u0935\\\\u094d\\\\u092f\\\\u0915\\\\u094d\\\\u0924\\\\u093f\\\", \\\"pos\\\": \\\"NN\\\"}, {\\\"token\\\": \\\"\\\\u0936\\\\u0949\\\\u092a\\\\u093f\\\\u0902\\\\u0917\\\", \\\"pos\\\": \\\"XC\\\"}], {\\\"token\\\": \\\"\\\\u0914\\\\u0930\\\", \\\"pos\\\": \\\"CC:\\\\u0914\\\\u0930\\\"}], [[{\\\"token\\\": \\\"\\\\u090f\\\\u092f\\\\u0930\\\\u092a\\\\u094b\\\\u0930\\\\u094d\\\\u091f\\\", \\\"pos\\\": \\\"NN\\\"}], [{\\\"token\\\": \\\"\\\\u0938\\\\u0947\\\", \\\"pos\\\": \\\"PSP:\\\\u0938\\\\u0947\\\"}, {\\\"token\\\": \\\"\\\\u092d\\\\u0940\\\", \\\"pos\\\": \\\"RP\\\"}]]], {\\\"token\\\": \\\"\\\\u0921\\\\u0930\\\\u0924\\\\u093e\\\", \\\"pos\\\": \\\"VM\\\"}], {\\\"token\\\": \\\"\\\\u0939\\\\u0948\\\", \\\"pos\\\": \\\"VAUX\\\"}]\"\n  # coffeelint: enable=max_line_length\n\n  init: ->\n    @test()\n\n  get_tree: (data) ->\n    parse = (nodes) ->\n      if Array.isArray(nodes)\n        if nodes.length is 2\n          children: (parse(_) for _ in nodes)\n          name: flat(nodes)\n        else\n          parse(nodes[0])\n      else\n        name: nodes.token\n\n    flat = (nodes) ->\n      if Array.isArray nodes\n        return (flat(node) for node in nodes).join(' ')\n      else\n        return nodes.token\n    parse JSON.parse(data)\n\n  test: ->\n    margin =\n      top: 40\n      right: 40\n      bottom: 40\n      left: 80\n    width = 960 - (margin.left) - (margin.right)\n    height = 400 - (margin.top) - (margin.bottom)\n    tree = d3.layout.tree().size([\n      width\n      height\n    ])\n    diagonal = d3.svg.diagonal().projection((d) ->\n      [\n        d.x\n        d.y\n      ]\n    )\n    svg = d3.select('#body')\n      .append('svg')\n        .attr('width', width + margin.left + margin.right)\n        .attr('height', height + margin.top + margin.bottom)\n          .append('g')\n            .attr('transform', \"translate(#{margin.left}, #{margin.top})\")\n\n    root = @get_tree @test_data\n\n    nodes = tree.nodes(root)\n    links = tree.links(nodes)\n    # Create the link lines.\n    svg.selectAll('.link')\n      .data(links)\n        .enter()\n        .append('path')\n          .attr('class', 'link')\n          .attr('d', diagonal)\n\n    # Create the node circles.\n    node = svg.selectAll('.node')\n      .data(nodes)\n        .enter()\n        .append('g')\n          .attr('class', (d) -> \"node #{d.type}\")\n          .attr('transform', (d) -> \"translate(#{d.x}, #{d.y})\")\n\n    {top, left} = $('#body').offset()\n\n    $('.toolbar').on 'mouseleave', (e) ->\n      $(@).addClass 'hidden'\n\n    node\n      .append 'circle'\n        .attr 'r', 10\n        .attr 'fill', '#FFF'\n        .on 'mouseover', (d) ->\n          self = @\n          $('.toolbar ul li').off 'click'\n          $('.toolbar')\n            .css 'top', d.y + top\n            .css 'left', d.x + left\n            .removeClass 'hidden'\n          $('.toolbar .phrase').text d.name\n\n          $('.toolbar ul li').on 'click', (e) ->\n            el = $(@)\n            d.sentiment = el.attr('role')\n            $(self).attr 'fill', el.css('background-color')\n            update_labels()\n\n    update_labels = ->\n      node\n        .append 'text'\n          .attr 'y', 4\n          .attr 'text-anchor', 'middle'\n          .attr 'class', 'sentiment'\n          .text (d) -> d.sentiment\n\n      node\n        .append 'text'\n          .attr 'y', 25\n          .attr 'text-anchor', 'middle'\n          .text (d) ->\n            unless d.children then d.name\n\n    update_labels()\n    window.nodes = nodes\n\n\nmodule.exports = App\n"]}